# 2025 OOPL Final Report

## 組別資訊

組別：36  
組員：112590003 蔡宗佑 112590056 陳泰蒝  
復刻遊戲：イニシエダンジョン  

## 專案簡介

### 遊戲簡介
イニシエダンジョン是我們小時候玩過的RPG地下城遊戲，遊戲的內容是玩家在地下城可以打怪，刷等級、裝備等等，然後一路向下通關的遊戲。這次實習選擇的是完成地下城的前10層，這個層數會到達第1個BOSS。  
這10層主要是分為兩個部分，1~5層以及6~10層，兩個區域的風格、地圖大小都有所不同，而怪物的部分，在各個不同層數會遇到的怪物都是截然不同的。  
密技的部分，點擊P可以獲得大量攻擊力，點擊L可以升1等。  
### 組別分工
蔡宗佑:  
樓層設計、怪物AI、彈射物、物品、技能、開場動畫  
陳泰蒝:  
按鈕事件、菜單、角色UI、背包、物品  
## 遊戲介紹

### 遊戲規則
WASD可以讓角色進行移動，上方數字鍵1~4或用滑鼠點擊快捷欄裝備武器、喝藥水，撞擊怪物會對其發動普通攻擊，點擊左鍵會對鼠標位置發動武器技能，長按背包、快捷欄中的物品可以拖曳，拖曳至其他格可以交換，拖曳至地圖上可以丟棄物品(丟在地上)。到樓梯處點按鈕可以下樓。  
### 遊戲畫面
![image](https://github.com/yoyo486213/2025-OOPL/blob/main/ptsd-template-main/Resources/PlayScreen/01.png)
![image](https://github.com/yoyo486213/2025-OOPL/blob/main/ptsd-template-main/Resources/PlayScreen/02.png)
![image](https://github.com/yoyo486213/2025-OOPL/blob/main/ptsd-template-main/Resources/PlayScreen/03.png)
![image](https://github.com/yoyo486213/2025-OOPL/blob/main/ptsd-template-main/Resources/PlayScreen/04.png)
![image](https://github.com/yoyo486213/2025-OOPL/blob/main/ptsd-template-main/Resources/PlayScreen/05.png)
## 程式設計

### 程式架構
主要架構包含：選單、怪物、地圖、物品、UI、介面  
每個部分都有部份連動  
選單的部分繼承了Menu，使用了各種Button作為成員來實作，並發出主要的控制訊號。  
怪物的部分皆是繼承自Monster，在後續實作不同的AI邏輯。  
地圖則包含了怪物、地圖物件、掉落物品等等，為主要內容的管理者。  
物品則是根據IUsable以及IEquipable這兩個介面的繼承來實作以及判斷是哪類型的物品。  
UI則控制玩家本身的背包以及狀態等等，物品欄會包含物品並且與地圖做連結。  
介面則有ICollidable、IClickable、IEquipable、IMoveable、IUsable來讓我們使用多型做物件的管理。
### 程式技術
為了讓我們的玩家可以自訂角色名稱，我們使用了一個圖片生成的函式，好讓我們可以透過玩家在選單中打的名字取得玩家名稱的圖片，用於放置在菜單和UI上。  
再來，在物品以及背包上使用了大量的多形來判斷該物品要使用何種功能，例如：當要使用藥水時，會將他轉為IUsable，判斷可以之後，就會呼叫他的Use()並消耗物品。武器亦然，當要觸發的是裝備時，也會確認是IEquipable再進行裝備。  
在怪物的邏輯的部分，因為原版中怪物是不會停在非完整格子上的(停留時一定會在一整格上)，所以當他停下來攻擊玩家時，由於怪物跟玩家不會卡在同一格，會需要補正玩家的格子，所以會讓怪物把玩家推到格子上。  
地圖生成時使用的是讀取JSON並根據內容來生物物件、圖片，並根據這個位置能否生成怪物(某些怪物如蝙蝠只會掛在特定物件上)，來判斷是否生成怪物，以此產生每一層樓的地圖。  
開門的時候會探察周遭相鄰的未發現區塊並將其顯示。
## 結語

### 問題與解決方法
最開始遇到的其中一個問題就是，由於我們設計地圖的程式是用左下角為(0,0)，而ptsd是以中心為(0,0)，所以在最開始會遇到一些物件歪掉的問題，在後來經過一系列的座標微調將其兩者對齊了。  
再來的問題包含各種怪物的邏輯，像是蛇的加速有時會衝歪掉，或是還沒看到玩家就進行衝刺，後來發現有一部份是玩家的座標跟世界座標沒有進行對齊導致的，也是經過調整解決了這個問題。
還有關於物品，當時在做判斷玩家是不是長按要拖動物品的判斷時，會因為判斷長按時間的變數一直被重設導致不知道玩家是長按，以及放開時因為已經跳出函式導致物品沒有被丟出，就一直捏在滑鼠上。不過後來重新設計過判斷是之後就解決了。  
最後關於物品要從UI丟到地圖上的時候，由於呼叫函式時我用來取得完整格子座標的對照物有可能不存在(因為換樓層等等原因被刪除重建)，導致一旦丟出物品就會因為找不到座標對照物crash，後來改成將要丟棄的物品放到m_DropItem之後再從地圖裡面把該Item丟出來才解決crash問題。
### 自評

| 項次 | 項目                   | 完成 |
|------|------------------------|-------|
| 1    | 完成專案權限改為 public | V |
| 2    | 具有 debug mode 的功能  | V |
| 3    | 解決專案上所有 Memory Leak 的問題  | V |
| 4    | 報告中沒有任何錯字，以及沒有任何一項遺漏  | V |
| 5    | 報告至少保持基本的美感，人類可讀  | V |

### 心得
這次的專案實作提升了我對OOP的理解，也讓我更了解要怎麼設計程式的架構，也讓我知道了更多程式的使用以及寫法，以及讓我更熟悉要如何在同一個專案進行團隊協作，最後讓一個完整能執行的程式被端出來。
### 貢獻比例
蔡宗佑 55%  
陳泰蒝 45%